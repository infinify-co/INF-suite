<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign in - Infinify</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- AWS Cognito -->
    <script src="https://unpkg.com/amazon-cognito-identity-js@6.3.0/dist/amazon-cognito-identity.min.js"></script>
    <script src="cognito-config.js"></script>
    <script src="cognito-auth.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #ffffff;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .signin-container {
            width: 100%;
            max-width: 400px;
        }

        .signin-card {
            background: #ffffff;
            border-radius: 12px;
            padding: 40px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .signin-title {
            font-family: 'Open Sans', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 8px;
            text-align: center;
        }

        .signin-description {
            font-family: 'Open Sans', sans-serif;
            font-size: 15px;
            color: #6b7280;
            margin-bottom: 32px;
            line-height: 1.5;
            text-align: center;
        }

        .infinify-button {
            width: 100%;
            padding: 12px 16px;
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-family: 'Open Sans', sans-serif;
            font-size: 13px;
            font-weight: 500;
            color: #6b7280;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 24px;
            transition: background-color 0.2s, border-color 0.2s;
        }

        .infinify-button:hover {
            background: #f9fafb;
            border-color: #d1d5db;
        }

        .infinify-logo {
            width: 20px;
            height: 20px;
            background-image: url('INF.Asset1.png');
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .divider {
            display: flex;
            align-items: center;
            margin-bottom: 24px;
            color: #9ca3af;
            font-size: 14px;
        }

        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: #e5e7eb;
        }

        .divider span {
            padding: 0 16px;
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 8px;
            margin-left: 0;
            margin-top: 0;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            font-size: 15px;
            color: #1f2937;
            outline: none;
            transition: border-color 0.2s, background-color 0.2s;
            box-sizing: border-box;
        }

        .form-input:focus {
            border-color: #3b82f6;
            background: #ffffff;
        }

        .form-input::placeholder {
            color: #9ca3af;
        }

        .form-input.error {
            border-color: #ef4444;
        }

        .error-message {
            display: none;
            align-items: center;
            gap: 6px;
            font-size: 14px;
            color: #ef4444;
            justify-content: flex-end;
            position: absolute;
            top: 12px;
            right: 0;
        }

        .error-message.show {
            display: flex;
        }

        .error-icon {
            width: 16px;
            height: 16px;
            min-width: 16px;
            border-radius: 50%;
            background: #ef4444;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .error-icon::before {
            content: '!';
            color: #ffffff;
            font-size: 12px;
            font-weight: 700;
            line-height: 1;
        }

        .continue-button {
            width: 100%;
            padding: 14px 16px;
            background: #000000;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            color: #ffffff;
            cursor: pointer;
            margin-top: 8px;
            margin-bottom: 10px;
            transition: background-color 0.2s;
        }

        .continue-button:hover {
            background: #1f2937;
        }

        /* Phone Number Button */
        .phone-button {
            width: 100%;
            padding: 12px 16px;
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-family: 'Open Sans', sans-serif;
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            transition: all 0.2s;
        }

        .phone-button:hover {
            background: #f9fafb;
            border-color: #d1d5db;
        }

        .phone-button-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .phone-icon {
            width: 18px;
            height: 18px;
            color: #6b7280;
        }

        .phone-button-text {
            color: #374151;
        }

        .phone-button-arrow {
            width: 16px;
            height: 16px;
            color: #9ca3af;
            transition: transform 0.2s;
        }

        .phone-button:hover .phone-button-arrow {
            transform: translateX(2px);
        }

        /* Modern Dropdown Styles */
        .modern-dropdown {
            position: relative;
            margin-bottom: 20px;
        }
        
        .modern-dropdown .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 8px;
            margin-left: 0;
            margin-top: 0;
        }

        .dropdown-button {
            width: 100%;
            padding: 12px 16px;
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            font-family: 'Open Sans', sans-serif;
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.2s;
            text-align: left;
            box-sizing: border-box;
        }

        .dropdown-button:hover {
            background: #f9fafb;
            border-color: #d1d5db;
        }

        .dropdown-button.active {
            border-color: #3b82f6;
            background: #ffffff;
        }

        .dropdown-button-text {
            flex: 1;
            color: #374151;
        }

        .dropdown-button-placeholder {
            color: #9ca3af;
        }

        .dropdown-arrow {
            width: 16px;
            height: 16px;
            color: #9ca3af;
            transition: transform 0.2s;
            flex-shrink: 0;
            margin-left: 12px;
        }

        .dropdown-button.active .dropdown-arrow {
            transform: rotate(180deg);
            color: #3b82f6;
        }

        .dropdown-menu {
            position: absolute;
            top: calc(100% + 4px);
            left: 0;
            right: 0;
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-height: 300px;
            overflow: hidden;
            display: none;
            flex-direction: column;
        }

        .dropdown-menu.show {
            display: flex;
        }

        .dropdown-search {
            padding: 12px 16px;
            border: none;
            border-bottom: 1px solid #e5e7eb;
            border-radius: 8px 8px 0 0;
            font-family: 'Open Sans', sans-serif;
            font-size: 14px;
            color: #374151;
            outline: none;
            background: #ffffff;
        }

        .dropdown-search::placeholder {
            color: #9ca3af;
        }

        .dropdown-list {
            max-height: 240px;
            overflow-y: auto;
            padding: 4px;
        }

        .dropdown-item {
            padding: 10px 16px;
            font-family: 'Open Sans', sans-serif;
            font-size: 14px;
            color: #374151;
            cursor: pointer;
            border-radius: 6px;
            transition: background-color 0.15s;
            display: block;
        }

        .dropdown-item:hover {
            background: #f3f4f6;
        }

        .dropdown-item.selected {
            background: #eff6ff;
            color: #3b82f6;
            font-weight: 600;
        }

        .dropdown-empty {
            padding: 16px;
            text-align: center;
            color: #9ca3af;
            font-size: 14px;
            font-family: 'Open Sans', sans-serif;
        }
    </style>
</head>
<body>
    <div class="signin-container">
        <div class="signin-card">
            <h1 class="signin-title">Sign up</h1>
            <p class="signin-description">Create your account to get started.</p>
            
            <!-- Industry Dropdown -->
            <div class="modern-dropdown">
                <label for="industry" class="form-label">Industry</label>
                <button type="button" class="dropdown-button" id="industryButton">
                    <span class="dropdown-button-text" id="industryButtonText">
                        <span class="dropdown-button-placeholder">Select industry</span>
                    </span>
                    <svg class="dropdown-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
    </button>
                <div class="dropdown-menu" id="industryMenu">
                    <input type="text" class="dropdown-search" id="industrySearch" placeholder="Search industries...">
                    <div class="dropdown-list" id="industryList"></div>
                            </div>
                        </div>

            <!-- Region/Continent Dropdown -->
            <div class="modern-dropdown">
                <label for="region" class="form-label">Region/Continent</label>
                <button type="button" class="dropdown-button" id="regionButton">
                    <span class="dropdown-button-text" id="regionButtonText">
                        <span class="dropdown-button-placeholder">Select region/continent</span>
                    </span>
                    <svg class="dropdown-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                    </svg>
                                    </button>
                <div class="dropdown-menu" id="regionMenu">
                    <input type="text" class="dropdown-search" id="regionSearch" placeholder="Search regions...">
                    <div class="dropdown-list" id="regionList"></div>
                            </div>
                        </div>

            <!-- Sign Up Form -->
            <form id="signinForm" novalidate>
                <div class="form-group">
                    <label for="email" class="form-label">Email</label>
                    <div class="error-message" id="email-error">
                        <div class="error-icon"></div>
                        <span>Email is required.</span>
                    </div>
                    <input 
                        type="email" 
                        id="email" 
                        name="email" 
                        class="form-input" 
                        placeholder="Email address"
                    >
                        </div>

                <div class="form-group">
                    <label for="phone" class="form-label">Phone Number</label>
                    <div class="error-message" id="phone-error">
                        <div class="error-icon"></div>
                        <span>Phone number is required.</span>
                    </div>
                    <input 
                        type="tel" 
                        id="phone" 
                        name="phone" 
                        class="form-input" 
                        placeholder="Phone number"
                    >
                </div>
                
                <div class="form-group">
                    <label for="password" class="form-label">Create Password</label>
                    <div class="error-message" id="password-error">
                        <div class="error-icon"></div>
                        <span>Password is required.</span>
                    </div>
                    <input 
                        type="password" 
                        id="password" 
                        name="password" 
                        class="form-input" 
                        placeholder="Enter your password"
                    >
                </div>
                
                <button type="submit" class="continue-button">Sign up</button>
            </form>
            
            <div class="divider">
                <span>OR</span>
            </div>
            
            <button class="infinify-button" type="button">
                <div class="infinify-logo"></div>
                <span>Continue with Infinify</span>
            </button>
        </div>
    </div>

    <script>
            // Custom validation
            function validateField(input, errorElement, errorMessage) {
                const value = input.value.trim();
                const errorText = errorElement.querySelector('span');
                
                if (!value) {
                input.classList.add('error');
                    if (errorText) {
                        errorText.textContent = errorMessage;
                    }
                    errorElement.classList.add('show');
                    return false;
                } else {
                input.classList.remove('error');
                    errorElement.classList.remove('show');
                    return true;
                }
            }

            function validateEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }

            // Get form elements
            const form = document.getElementById('signinForm');
            const emailInput = document.getElementById('email');
            const phoneInput = document.getElementById('phone');
            const passwordInput = document.getElementById('password');
            const emailError = document.getElementById('email-error');
            const phoneError = document.getElementById('phone-error');
            const passwordError = document.getElementById('password-error');

            // Real-time validation
            emailInput.addEventListener('blur', function() {
                const value = this.value.trim();
                const errorText = emailError.querySelector('span');
                if (!value) {
                    validateField(this, emailError, 'Email is required.');
                } else if (!validateEmail(value)) {
                this.classList.add('error');
                    if (errorText) {
                        errorText.textContent = 'Please enter a valid email address.';
                    }
                    emailError.classList.add('show');
                } else {
                this.classList.remove('error');
                    emailError.classList.remove('show');
                }
            });

            passwordInput.addEventListener('blur', function() {
                validateField(this, passwordError, 'Password is required.');
            });

            // Clear errors on input
            emailInput.addEventListener('input', function() {
            if (this.classList.contains('error') && this.value.trim()) {
                this.classList.remove('error');
                    emailError.classList.remove('show');
                }
            });

            passwordInput.addEventListener('input', function() {
            if (this.classList.contains('error') && this.value.trim()) {
                this.classList.remove('error');
                    passwordError.classList.remove('show');
                }
            });

            // Handle form submission
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                let isValid = true;
                
                // Validate email
                const emailValue = emailInput.value.trim();
                const emailErrorText = emailError.querySelector('span');
                if (!emailValue) {
                    validateField(emailInput, emailError, 'Email is required.');
                    isValid = false;
                } else if (!validateEmail(emailValue)) {
                emailInput.classList.add('error');
                    if (emailErrorText) {
                        emailErrorText.textContent = 'Please enter a valid email address.';
                    }
                    emailError.classList.add('show');
                    isValid = false;
                } else {
                emailInput.classList.remove('error');
                    emailError.classList.remove('show');
                }
                
            // Validate phone
            if (!validateField(phoneInput, phoneError, 'Phone number is required.')) {
                isValid = false;
                }
                
                // Validate password
                if (!validateField(passwordInput, passwordError, 'Password is required.')) {
                    isValid = false;
                }
                
                if (isValid) {
                    // Show loading state
                const submitButton = form.querySelector('.continue-button');
                    const originalButtonText = submitButton.textContent;
                    submitButton.disabled = true;
                submitButton.textContent = 'Signing up...';
                    
                    const email = emailInput.value.trim();
                    const password = passwordInput.value;
                    
                    // Wait for authManager to be available
                    const processSignin = async () => {
                        try {
                            if (!window.authManager && !window.cognitoAuthManager) {
                                // Wait a bit for scripts to load
                                await new Promise(resolve => setTimeout(resolve, 1000));
                                if (!window.authManager && !window.cognitoAuthManager) {
                                    throw new Error('Authentication service not available. Please refresh the page.');
                                }
                            }
                            
                            // Use Cognito auth manager
                            const authMgr = window.cognitoAuthManager || window.authManager;
                            
                            // Sign in
                            await authMgr.signIn(email, password);
                            
                            // Update last login timestamp
                            if (authMgr.user) {
                                await authMgr.updateLastLogin(authMgr.user.id);
                            }
                            
                            // Redirect to home.html
                            window.location.href = 'home.html';
                            
                        } catch (error) {
                            console.error('Sign in error:', error);
                            
                            // Show error message
                            const errorMessage = error.message || 'Invalid email or password. Please try again.';
                            const emailErrorText = emailError.querySelector('span');
                        emailInput.classList.add('error');
                            if (emailErrorText) {
                                emailErrorText.textContent = errorMessage;
                            }
                            emailError.classList.add('show');
                            
                            // Reset button
                            submitButton.disabled = false;
                            submitButton.textContent = originalButtonText;
                        }
                    };
                    
                    processSignin();
                }
            });

        // Handle Infinify button click
        document.querySelector('.infinify-button').addEventListener('click', function() {
            // Add your OAuth/SSO logic here
            console.log('Continue with Infinify clicked');
        });

        // Industry and Region Data
        const industries = [
            'Technology', 'Healthcare', 'Finance', 'Education', 'Retail', 'Manufacturing',
            'Real Estate', 'Transportation', 'Energy', 'Media & Entertainment', 'Hospitality',
            'Agriculture', 'Construction', 'Telecommunications', 'Automotive', 'Aerospace',
            'Food & Beverage', 'Fashion', 'Sports', 'Legal', 'Consulting', 'Non-profit',
            'Government', 'Pharmaceuticals', 'Biotechnology', 'E-commerce', 'Gaming',
            'Travel & Tourism', 'Insurance', 'Banking', 'Marketing', 'Advertising'
        ];

        const regions = [
            'North America', 'South America', 'Europe', 'Asia', 'Africa', 'Oceania',
            'Middle East', 'Central America', 'Caribbean', 'Antarctica', 'United States',
            'Canada', 'Mexico', 'Brazil', 'Argentina', 'United Kingdom', 'Germany',
            'France', 'Italy', 'Spain', 'China', 'Japan', 'India', 'South Korea',
            'Australia', 'New Zealand', 'South Africa', 'Egypt', 'Nigeria', 'Saudi Arabia',
            'United Arab Emirates', 'Russia', 'Turkey', 'Poland', 'Netherlands'
        ];

        // Phone Number Input Handler
        phoneInput.addEventListener('blur', function() {
            validateField(this, phoneError, 'Phone number is required.');
        });

        phoneInput.addEventListener('input', function() {
            if (this.classList.contains('error') && this.value.trim()) {
                this.classList.remove('error');
                phoneError.classList.remove('show');
            }
        });

        // Dropdown Functionality
        function initDropdown(buttonId, menuId, searchId, listId, data, placeholder) {
            const button = document.getElementById(buttonId);
            const menu = document.getElementById(menuId);
            const search = document.getElementById(searchId);
            const list = document.getElementById(listId);
            const buttonText = document.getElementById(buttonId + 'Text');
            let selectedValue = '';

            // Populate dropdown list
            function populateList(items) {
                list.innerHTML = '';
                if (items.length === 0) {
                    list.innerHTML = '<div class="dropdown-empty">No results found</div>';
                    return;
                }
                items.forEach(item => {
                    const itemEl = document.createElement('div');
                    itemEl.className = 'dropdown-item';
                    if (item === selectedValue) {
                        itemEl.classList.add('selected');
                    }
                    itemEl.textContent = item;
                    itemEl.addEventListener('click', function() {
                        selectedValue = item;
                        buttonText.innerHTML = item;
                        button.classList.remove('active');
                        menu.classList.remove('show');
                        search.value = '';
                        populateList(data);
                    });
                    list.appendChild(itemEl);
                });
            }

            // Initial population
            populateList(data);

            // Toggle dropdown
            button.addEventListener('click', function(e) {
                e.stopPropagation();
                const isActive = button.classList.contains('active');
                
                // Close all other dropdowns
                document.querySelectorAll('.dropdown-menu').forEach(m => {
                    if (m !== menu) m.classList.remove('show');
                });
                document.querySelectorAll('.dropdown-button').forEach(b => {
                    if (b !== button) b.classList.remove('active');
                });

                if (isActive) {
                    button.classList.remove('active');
                    menu.classList.remove('show');
                } else {
                    button.classList.add('active');
                    menu.classList.add('show');
                    search.focus();
                }
            });

            // Search functionality
            search.addEventListener('input', function() {
                const query = this.value.toLowerCase().trim();
                const filtered = data.filter(item => 
                    item.toLowerCase().includes(query)
                );
                populateList(filtered);
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(e) {
                if (!button.contains(e.target) && !menu.contains(e.target)) {
                    button.classList.remove('active');
                    menu.classList.remove('show');
                    search.value = '';
                    populateList(data);
                }
            });
        }

        // Initialize dropdowns
        initDropdown('industryButton', 'industryMenu', 'industrySearch', 'industryList', industries, 'Select industry');
        initDropdown('regionButton', 'regionMenu', 'regionSearch', 'regionList', regions, 'Select region/continent');
    </script>
</body>
</html>

